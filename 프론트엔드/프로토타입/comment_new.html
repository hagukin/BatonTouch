<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>comment_new</title>
</head>
<script src="https://code.jquery.com/jquery-1.12.4.js" 
integrity="sha256-Qw82+bXyGq6MydymqBxNPYTaUXXq7c8v3CwiYwLLNXU=" 
crossorigin="anonymous">
</script>
<script>
    var comments_list =[
        {
            idx : 'admin1',
            comment : '댓글 기능 구현 예제 댓글 1번',
            recommend : 0
        },
        {
            idx : 'admin2',
            comment : '댓글 기능 구현 예제 댓글 2번',
            recommend : 10
        },
        {
            idx : 'admin3',
            comment : '댓글 기능 구현 예제 댓글 3번',
            recommend : 23
        },
        {
            idx : 'admin4',
            comment : '댓글 기능 구현 예제 댓글 4번',
            recommend : 0
        },
        {
            idx : 'admin5',
            comment : '댓글 기능 구현 예제 댓글 5번',
            recommend : 2123
        },
    ];

    // id="comment_area"에 HTMLElement추가
    function addElementInCommentArea(comment_list_idx){
        $('#comment_area').prepend('<li><textarea>'+comments_list[comment_list_idx].comment+'</textarea></li>'
        +'<input class="btn_comment_recomm" type="button" value='+String(comments_list[comment_list_idx].recommend) +'>');
    }
    
    $(document).ready(function(){
        const max_comment_list_item = 3; // 한 화면에 출력되는 코멘트 개수
        var comment_list_top_idx = 0; // 화면에 출력되어 있는 코멘트 중 가장 높은 인덱스
        var comment_list_bottom_idx = 0; // 화면에 출력되어 있는 코멘트 중 가장 낮은 인덱스

        // 페이지가 로드되었을때 1번 실행 - comment 리스트 출력
        for(var i = 0;i<comments_list.length;i++){
            addElementInCommentArea(i);
            
            if ($('#comment_area').children('li').length > (max_comment_list_item - 1)) {
                comment_list_top_idx += (max_comment_list_item - 1);
                break;
            }
        }
        
        // 이벤트 핸들러 - 사용자 문장 입력에 대한 확인 버튼
        $('#btn_confirm').on("click", function(){
            var elem = document.getElementById('comment_input');

            comments_list.push({
            idx : 'admin7',
            comment : elem.value,
            recommend : 0,
            });

            $('#user_comment_area').prepend('<li><textarea>'+elem.value+'</textarea></li>'
            +'<input class="btn_comment_recomm" type="button" value="0">');
        })

        // 이벤트 핸들러 - 다음 comment 리스트 출력
        $('#control_tool_next').on("click", function(){
            if(comment_list_top_idx == comments_list.length - 1){
                console.log('마지막 페이지!');
                return;
            }

            comment_list_bottom_idx = comment_list_top_idx + 1;
            $('#comment_area').empty();

            for (var i = comment_list_bottom_idx; i < comments_list.length; i++) {
                addElementInCommentArea(i);
                comment_list_top_idx++;
                if ($('#comment_area').children('li').length > (max_comment_list_item - 1)) {
                    break;
                }
            }
        })

        // 이벤트 핸들러 - 이전 comment 리스트 출력
        $('#control_tool_previous').on("click", function(){
            if(comment_list_bottom_idx == 0){
                console.log('첫번째 페이지');
                return;
            }

            comment_list_top_idx = comment_list_bottom_idx - 1;
            $('#comment_area').empty();
            for (var i = comment_list_top_idx; i >= 0; i--) {
                addElementInCommentArea(i);
                comment_list_bottom_idx--;
                if ($('#comment_area').children('li').length > (max_comment_list_item - 1)) {
                    break;
                }
            }
        })
    });

    

</script> 
<body>
    <textarea id="comment_input" name="comment_user_input" cols="30" rows="10">글을 입력하세요</textarea>
    <input id="btn_confirm" type="button" value="확인">
    <div>
        <div id="user_comment_area"></div>
        <div id="comment_area"></div>
        <div id="list_control_toolbar">
            <input id="control_tool_previous" type="button" value="이전">
            <input id="control_tool_next" type="button" value="다음">
        </div>
    </div>
    

</body>
</html>

